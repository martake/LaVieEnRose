# La Vie En Rose スーパーライト面白版（2D射影世界）仕様書

## 1. 目的

本仕様は La Vie En Rose の思想を、

- 数式的には最小限
- 実装はHTML+JSで完結
- 観察者（人間）には「説明できない動き」に見える
- エージェント内部では「世界を推定して賢くなっていく」

という スーパーライトかつ面白い可視化デモ として実装することを目的とする。

## 2. 世界モデルの全体像

### 2.1 世界の階層構造

- 潜在世界（真の世界）
- k次元連続空間（k=3を推奨）
- エージェント・ユーザとも直接観測不可
- 観測世界（可視世界）
- 2次元平面
- 潜在世界を固定射影した結果のみが見える

潜在状態 $s_t \in \mathbb{R}^3$
|
| 固定射影 $P \in \mathbb{R}^{2 \times 3}$
v
観測状態 $o_t \in \mathbb{R}^2$ ← ユーザが見る世界

## 3. 数理モデル

### 3.1 潜在状態

潜在状態ベクトル

$s_t \in \mathbb{R}^3$

### 3.2 観測（射影）モデル

$o_t = P \cdot s_t$

- P : 固定の 2×3 行列
- P は 既知（実装側で固定）
- ユーザ・エージェントともに「2Dしか見えない」

### 3.3 世界の変化式（真のダイナミクス）

$s_{t+1} = A(\theta) \cdot s_t + B \cdot a_t + \varepsilon_t$

- $A(\theta) : 未知パラメータ \theta を含む 3×3 行列
- $a_t$ : エージェントの行動（2D移動ベクトル）
- $B$ : 行動入力を潜在空間へ持ち上げる行列（3×2）
- $\varepsilon_t$ : 小さなノイズ（省略可）

推奨パラメータ構成（θ）

- 回転角 $\theta_r$
- スケール $\theta_s$
- 潜在ドリフト $\theta_d$（Z方向など）

→ 未知係数は 3〜4個に抑えること

## 4. エージェントモデル

### 4.1 観測できるもの

- 現在の観測位置 $o_t$
- 過去の履歴 { ($a_t$, $o_t$) }

### 4.2 エージェントが持つ内部モデル

- 推定された潜在状態 $\hat{s}_t$
- 推定された係数 $\hat{\theta}$
- 世界予測モデル

$\hat{s}_{t+1} = A(\hat{\theta}) \cdot \hat{s}_t + B \cdot a_t$
$\hat{o}_{t+1} = P \cdot \hat{s}_{t+1}$

## 5. 行動選択

### 5.1 行動空間

2D移動ベクトル

$a_t \in \mathbb{R}^2$

小さな離散集合でも可（上下左右など）

### 5.2 行動評価

各候補行動 a について

score(a) = 期待報酬 - 移動コスト + 探索ボーナス

探索ボーナス（重要）

- 予測誤差が大きくなりそうな行動を評価 ＝ 世界を揺さぶる行動 を好む

$info*gain ≈ |o*{t+1} - \hat{o}\_{t+1}|$

## 6. 係数推定（学習）

### 6.1 観測誤差

$e_t = o_{t+1} - \hat{o}_{t+1}$

### 6.2 推定方法（軽量）

候補：

- 勾配降下
- 逐次最小二乗法（RLS）
- 簡易カルマンフィルタ

※ 精度より「学習していく様子が見える」ことを重視

## 7. 報酬設計（La Vie En Rose要素）

- 報酬は 潜在状態 $s_t$ で決定
- 観測2Dからは直接わからない

例：

$R_t = -||s_t||^2$ # 安定志向
$R_t = +z_t$ # 見えない次元への欲望
$R_t = \sin(z_t)$ # 説明不能な快・不快

→ 2Dだけ見ていると「理由不明な幸運・不運」に見える

## 8. 可視化UI要件

### 8.1 必須表示

- 2D平面上の現在位置（実線）
- 予測位置（点線）
- 過去軌跡

### 8.2 補助表示（右ペイン等）

- 現在の推定係数 $\hat{\theta}$
- 推定誤差の大きさ -行動選択理由（スコア内訳）

## 9. 面白さの演出ポイント

- 学習初期：予測が外れまくる
- 中盤：説明不能な動きが減る
- 終盤：突然「世界を理解した」かのように安定

観測者は

何が起きてるのかわからないが、だんだん賢くなっている

という感覚を得られることを目標とする。

## 10. 実装制約

- HTML + JS 単一ページ
- 外部ライブラリ不要（Math.js程度は可）
- 数式は線形代数中心
- 可読性・改変容易性を優先
- エージェントの選択の理由、学習の様子がわかるログを表示、ゆっくりとした動作速度

## 11. 到達目標

- 「世界は2Dに見えているだけ」という体験が直感的に伝わる
- La Vie En Rose の
  - 世界認識の歪み
  - 観測と真実の乖離
  - 学習による世界像の収束

を 説明抜きでも感じられる デモを完成させる
